<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Đặt lịch hẹn</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
          rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
          rel="stylesheet">

    <!-- Patient CSS -->
    <link rel="stylesheet" th:href="@{/css/patient/sidebar.css}">
    <link rel="stylesheet" th:href="@{/css/patient/topbar.css}">
    <link rel="stylesheet" th:href="@{/css/patient/appointments.css}">
</head>

<body>

<!-- ===== TOPBAR ===== -->
<div th:replace="~{patient/fragments/topbar :: topbar}"></div>

<div class="d-flex">
    <!-- ===== SIDEBAR ===== -->
    <div th:replace="~{patient/fragments/sidebar :: sidebar}"></div>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="main-content">

        <!-- Header -->
        <div class="mb-4">
            <h3 class="fw-bold">Đặt lịch hẹn mới</h3>
            <p class="text-muted">Vui lòng điền đầy đủ thông tin để đặt lịch hẹn</p>
        </div>

        <!-- Create Appointment Form -->
        <div class="card border-0 shadow-sm card-rounded">
            <div class="card-body p-4">
                <form th:action="@{/patient/appointments/create}" method="post">
                    
                    <!-- Service -->
                    <div class="mb-3">
                        <label for="serviceId" class="form-label fw-semibold">
                            Dịch vụ <span class="text-danger">*</span>
                        </label>
                        <select class="form-select" id="serviceId" name="serviceId" required>
                            <option value="">-- Chọn dịch vụ --</option>
                            <option th:each="service : ${services}" 
                                    th:value="${service.id}" 
                                    th:text="${service.name}">
                                Dịch vụ
                            </option>
                        </select>
                    </div>

                    <!-- Dentist -->
                    <div class="mb-3">
                        <label for="dentistId" class="form-label fw-semibold">
                            Nha sĩ <span class="text-danger">*</span>
                        </label>
                        <select class="form-select" id="dentistId" name="dentistId" required>
                            <option value="">-- Chọn nha sĩ --</option>
                            <option th:each="dentist : ${dentists}" 
                                    th:value="${dentist.id}"
                                    th:text="${dentist.user != null ? dentist.user.email : 'Nha sĩ'} + (${dentist.specialization != null ? dentist.specialization : 'Nha sĩ tổng quát'})">
                                Nha sĩ
                            </option>
                        </select>
                    </div>

                    <!-- Date -->
                    <div class="mb-3">
                        <label for="date" class="form-label fw-semibold">
                            Ngày hẹn <span class="text-danger">*</span>
                        </label>
                        <input type="date" 
                               class="form-control" 
                               id="date" 
                               name="date" 
                               th:min="${#temporals.format(#temporals.createToday(), 'yyyy-MM-dd')}"
                               required>
                    </div>

                    <!-- Time -->
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="startTime" class="form-label fw-semibold">
                                Giờ bắt đầu <span class="text-danger">*</span>
                            </label>
                            <input type="time" 
                                   class="form-control" 
                                   id="startTime" 
                                   name="startTime" 
                                   required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="endTime" class="form-label fw-semibold">
                                Giờ kết thúc <span class="text-danger">*</span>
                            </label>
                            <input type="time" 
                                   class="form-control" 
                                   id="endTime" 
                                   name="endTime" 
                                   required>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="d-flex gap-2 mt-4">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check-circle me-2"></i>Đặt lịch
                        </button>
                        <a th:href="@{/patient/appointments}" class="btn btn-outline-secondary">
                            <i class="bi bi-x-circle me-2"></i>Hủy
                        </a>
                        <a th:href="@{/patient/appointments/available}" class="btn btn-outline-info ms-auto">
                            <i class="bi bi-calendar-check me-2"></i>Xem lịch trống
                        </a>
                    </div>

                </form>
            </div>
        </div>

    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

