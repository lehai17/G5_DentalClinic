<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chỉnh sửa Profile</title>
    <link rel="stylesheet" th:href="@{/css/home.css}">

    <style>
        .card {
            max-width: 720px;
            margin: 30px auto;
            background: #fff;
            padding: 22px;
            border-radius: 14px;
            border: 1px solid #e5e7eb;
        }
        .form-grid { display: grid; gap: 12px; }
        .label { display:block; color:#6b7280; font-size:13px; margin-bottom:6px; }
        .input {
            width:100%;
            padding:10px 12px;
            border:1px solid #e5e7eb;
            border-radius:10px;
            outline: none;
        }
        .input:focus { border-color:#4f46e5; box-shadow: 0 0 0 3px rgba(79,70,229,.12); }

        /* error style */
        .input.is-invalid { border-color: #ef4444; box-shadow: 0 0 0 3px rgba(239,68,68,.12); }
        .field-error { color:#ef4444; font-size:12px; margin-top:6px; display:block; }

        .alert-error {
            padding:10px 12px;
            border-radius:10px;
            background:#fee2e2;
            color:#991b1b;
            margin-bottom:12px;
        }
        .alert-success {
            padding:10px 12px;
            border-radius:10px;
            background:#dcfce7;
            color:#166534;
            margin-bottom:12px;
        }
        .actions { display:flex; gap:10px; margin-top:6px; }
        .btn-primary {
            padding:10px 14px;
            border-radius:10px;
            border:0;
            background:#4f46e5;
            color:#fff;
            font-weight:600;
            cursor:pointer;
        }
        .btn-outline {
            padding:10px 14px;
            border-radius:10px;
            border:1px solid #e5e7eb;
            background:#fff;
            color:#111827;
            text-decoration:none;
            font-weight:600;
        }
    </style>
</head>

<body>
<div class="app-wrapper">
    <div th:replace="~{fragments/header :: header}"></div>

    <div class="card">
        <h2 style="font-size:22px;font-weight:700;margin-bottom:14px;">Chỉnh sửa thông tin</h2>

        <!-- Global message -->
        <div class="alert-error" th:if="${error}">
            <span th:text="${error}"></span>
        </div>

        <div class="alert-success" th:if="${success}">
            <span th:text="${success}"></span>
        </div>

        <!-- ✅ bind form -->
        <form th:action="@{/profile/edit}" method="post"
              th:object="${form}" class="form-grid" novalidate>

            <!-- Full name -->
            <div>
                <label class="label" for="fullName">Họ tên</label>
                <input id="fullName"
                       class="input"
                       th:classappend="${#fields.hasErrors('fullName')} ? ' is-invalid' : ''"
                       type="text"
                       th:field="*{fullName}"
                       placeholder="Nhập họ tên"
                       required>
                <small class="field-error"
                       th:if="${#fields.hasErrors('fullName')}"
                       th:errors="*{fullName}"></small>
            </div>

            <!-- Phone -->
            <div>
                <label class="label" for="phone">Số điện thoại</label>
                <input id="phone"
                       class="input"
                       th:classappend="${#fields.hasErrors('phone')} ? ' is-invalid' : ''"
                       type="text"
                       th:field="*{phone}"
                       placeholder="0xxxxxxxxx (9–10 số)"
                       inputmode="numeric"
                       maxlength="10">
                <small class="field-error"
                       th:if="${#fields.hasErrors('phone')}"
                       th:errors="*{phone}"></small>
            </div>

            <!-- Date of birth -->
            <div>
                <label class="label" for="dateOfBirth">Ngày sinh</label>
                <input id="dateOfBirth"
                       class="input"
                       type="date"
                       th:field="*{dateOfBirth}">
            </div>

            <!-- Address -->
            <div>
                <label class="label" for="address">Địa chỉ</label>
                <input id="address"
                       class="input"
                       type="text"
                       th:field="*{address}"
                       placeholder="Nhập địa chỉ">
            </div>

            <div class="actions">
                <button type="submit" class="btn-primary">Lưu thay đổi</button>
                <a th:href="@{/profile}" class="btn-outline">Hủy</a>
            </div>

        </form>
    </div>
</div>

<script th:src="@{/js/user-dropdown.js}" defer></script>
</body>
</html>
