<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Report Absence - DentalPlus</title>
    <link rel="stylesheet" th:href="@{/css/dentist/app.css}"/>
    <link rel="stylesheet" th:href="@{/css/dentist/support.css}"/>
    <link rel="stylesheet" th:href="@{/css/dentist/busy-schedule.css}"/>
</head>
<body>
<div class="app-shell">

    <aside class="sidebar" id="sidebar" style="display:flex; flex-direction:column; height:100vh;">
        <div class="sidebar-top">
            <div class="brand-mini">
                <div class="brand-badge">D+</div>
                <div style="font-weight:800">DentalPlus</div>
            </div>
        </div>

        <nav class="nav">
            <a class="nav-item" href="/dentist/dashboard">Dashboard</a>
            <a class="nav-item" href="/dentist/work-schedule">Work Schedule</a>
            <a class="nav-item active" href="/dentist/busy-schedule">Busy Schedule</a>
            <a class="nav-item" href="/dentist/support">Support Tickets</a>
            <a class="nav-item" href="/dentist/profile">My Profile</a>
        </nav>

        <div style="margin-top:auto;">
            <a class="nav-item danger" href="/logout">Sign Out</a>
        </div>
    </aside>

    <div class="main">
        <div class="topbar">
            <div style="color:var(--muted); font-size:12px;">Modules › Work Schedule › Report Absence</div>
        </div>

        <div class="content">
            <div class="busy-container">
                <div class="busy-header">
                    <h2>Request Time Off / Busy Schedule</h2>
                    <p>The system will automatically notify and assist in rescheduling/canceling appointments for affected patients.</p>
                </div>

                <form th:action="@{/dentist/busy-schedule/submit}" method="post" class="busy-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate">From Date</label>
                            <input type="date" name="startDate" id="startDate" required
                                   th:min="${#temporals.format(#temporals.createNow(), 'yyyy-MM-dd')}">
                        </div>
                        <div class="form-group">
                            <label for="endDate">To End of Date</label>
                            <input type="date" name="endDate" id="endDate" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="reason">Reason for Absence (Sent to Manager & Patients)</label>
                        <textarea name="reason" id="reason" rows="4"
                                  placeholder="Example: I have an unexpected business trip or personal leave..." required></textarea>
                    </div>

                    <div class="form-actions">
                        <a href="/dentist/work-schedule" class="btn-secondary">Cancel</a>
                        <button type="submit" class="btn-primary">Confirm Absence Request</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Logic to ensure End Date is not before Start Date
    document.getElementById('startDate').addEventListener('change', function() {
        const endDate = document.getElementById('endDate');
        if (!endDate.value || endDate.value < this.value) {
            endDate.value = this.value;
        }
        endDate.min = this.value;
    });
</script>

</body>
</html>